---

title: "Admin Blog Management API Documentation"
description: "REST API reference for Admin Blog Management (create/edit/review/version, comment moderation, analytics, and deletions)."
---

# Admin Blog Management

REST API reference for admin-facing blog management: drafting, image uploads, reviewer/approver workflows, versioning, assigning reviewers/approvers, comment moderation (both user-visible and admin-review comments), analytics, and deletions.

---

## Base URL

```
/api/fitnearn/web/admin/blog
```

(Note: user-visible comment endpoints live under `/api/fitnearn/web/admin/blog-comment/*`. Some admin helper comment operations remain under `/api/fitnearn/web/admin/blog/*`.)

---

## Shared middleware & utilities (remembered)

* `authenticateAdminToken` — validates admin JWT and attaches admin context to `req`.
* `authorize(permission | permissionArray)` / `authorizeMultiple(...)` — permission checks (e.g. `GET_BLOGS`, `EDIT_BLOG`, `DELETE_BLOG`, `ADD_REVIEWER_COMMENT_BLOG`, `ADD_APPROVER_COMMENT_BLOG`, `EDIT_COMMENT`, `DELETE_COMMENT`).
* `upload.single('image')` (from `imageHandler`) — accepts image uploads and exposes `req.file`.
* `generateUniqueSequence` / `idGenerationMiddleware('CMT')` — generates unique IDs for comments/version objects.
* `helperFunctionVerifyUserGenTempCre` — helpers for temporary upload credentials.
* `presignedUrl` utilities — temporary signed URLs for S3 assets.
* `validateBlogStatus` — route-level validator for allowable blog state transitions.

---

## Models used (selected from `index.d.ts`)

> Only key fields relevant to controller payloads/responses are listed.

### `IBlog` / `Blog`

* `blogId` / `_id`, `title`, `slug`, `summary`, `meta`, `content`, `authorId`, `authorName`
* `stage`, `status` (`draft` | `under_review` | `approved` | `published` | `rejected`)
* `version`,
* `tags`, `category`, `readingTime`, `thumbnail`, `images[]`, `createdAt`, `updatedAt`

### `IBlogComment` / `BlogComment`

* `commentId` / `_id`, `blogId`, `userId`, `adminId`, `text`, `status` (`active`|`deleted`|`flagged`), `parentId`, `replyCount`, `createdAt`, `updatedAt`

### `IBlogImage` / `BlogImage`

* `imageId`, `key`, `url`, `altText`, `uploadedBy`, `uploadedAt`

### `IAdminBlogReview` / `AdminBlogReview`

* `blogId`, `reviewerAdminId`, `approverAdminId`, `reviewer.comments[]`, `approver.comments[]`, `stage`, `lock` (boolean), timestamps

### `IReportModel` / `Report`

* `targetId` (blogId | commentId), `reporterId`, `reason`, `status`

---

## How this doc is organised

* Core blog management endpoints (create/draft/update/save/version/publish/delete)
* Reviewer & approver workflows (stage1/stage2)
* Image upload & lifecycle
* Comment moderation (two domains: **user-visible** `BlogComment` and **admin-review** `AdminBlogReview`)
* Analytics, reported items, assignment endpoints, and notes

Each endpoint lists method, path, middleware, controller, request shape, short *Functioning* description, sample success shape and common errors.

---

## Endpoints

> The routes below reflect the controllers in `adminBlogRoutes.ts` and `adminBlogController.ts`. If an endpoint in your codebase has different param names, use the controller code as source of truth.

---

### 1. Save Draft Blog (admin)

* **Method:** `POST`
* **URL:** `/api/fitnearn/web/admin/blog/save-draft`
* **Middleware:** `authenticateAdminToken`, `authorize('CREATE_BLOG')`
* **Controller:** `adminCreateDraftBlog`
* **Request Body (typical):**

```json
{ "title","summary","content","authorId","tags","category","thumbnail?" }
```

* **Functioning:** validates admin and minimal fields, persists `Blog` with `stage: "draft"`, generates `blogId` if required.
**Success:** `{ success: true, message: "Draft saved", data: { /* blog */ } }`
**Errors:** `400` missing title/content; `500` DB failure.

---

### 2. Upload File (image upload to S3)

* **Method:** `POST`
* **URL:** `/api/fitnearn/web/admin/blog/upload-file`
* **Middleware:** `authenticateAdminToken`, `authorize('EDIT_BLOG')`, `upload.single('image')`
* **Controller:** `uploadFile`
* **Request:** multipart/form-data with `image` plus optional `altText`, `blogId`.
* **Functioning:** receives `req.file`, uploads via `imageHandler` to S3, returns media metadata and optionally creates `BlogImage` record.
  **Success:** `{ success: true, data: { url, key, imageId } }`
  **Errors:** `400` invalid file; `500` S3/upload failure.

---

### 3. Reviewer — Review Blog (stage 1)

* **Method:** `POST`
* **URL:** `/api/fitnearn/web/admin/blog/review-blog`
* **Middleware:** `authenticateAdminToken`, `authorizeMultiple(['ADD_REVIEWER_COMMENT_BLOG','GET_BLOGS'])`, `validateBlogStatus`
* **Controller:** `reviewerAdminReview`
* **Request Body:**

```json
{ "blogId", "adminId", "comment", "action" } // action: "save" | "request_changes" | "send_to_approver"
```

* **Functioning:** creates/updates `AdminBlogReview` for reviewer. When `lock === false`, reviewer can save drafts or request changes. `send_to_approver` finalizes reviewer comment and sets `lock = true`; moves stage to approver. Audit recorded.
**Success:** updated review + blog stage.
**Errors:** `403`, `400`, `500`.

---

### 4. Approver — Approve / Reject / Save (stage 2)

* **Method:** `PATCH`
* **URL:** `/api/fitnearn/web/admin/blog/approver-review`
* **Middleware:** `authenticateAdminToken`, `authorizeMultiple(['ADD_APPROVER_COMMENT_BLOG','GET_BLOGS'])`, `validateBlogStatus`
* **Controller:** `approverAdminReview`
* **Request Body:**

```json
{ "blogId", "approverAdminId", "comment", "action" } // action: "save" | "approve" | "reject"
```

* **Functioning:** approver saves or finalizes review. Final actions set `lock = true`. On `approve`, advance `status`/`stage` and trigger publish-related side-effects; on `reject`, set rejected state and notify.
**Success:** updated blog + review audit.
**Errors:** `409` lock true; `500`.

---

### 5. Create Version

* **Method:** `POST`
* **URL:** `/api/fitnearn/web/admin/blog/version-blog/:blogId`
* **Middleware:** `authenticateAdminToken`, `authorize('VERSION_BLOG')`, `validateBlogStatus`
* **Controller:** `versionBlog`
* **URL Params:** `blogId`
* **Functioning:** copies blog into new version doc, links via `previousVersionId`, sets `blogId` as `blogId:V{version-number}`.
  **Success:** `{ success: true, message: "Version created", data: { /* new version */ } }`

---

### 6. Update Blog (admin edits)

* **Method:** `PATCH`
* **URL:** `/api/fitnearn/web/admin/blog/update`
* **Middleware:** `authenticateAdminToken`, `authorize('EDIT_BLOG')`, `validateBlogStatus`
* **Controller:** `updateBlog`
* **Request Body:** `{ blogId, ...fieldsToUpdate, imagesToDelete? }`
* **Functioning:** applies allowed updates; when images are removed, deletes S3 keys and `BlogImage` entries. May reset review locks or spawn a new review record depending on workflow.
  **Success:** updated blog object.
  **Errors:** `400`, `403`, `500`.

---

### 7. Save Blog Post (send for review / publish flow)

* **Method:** `PATCH`
* **URL:** `/api/fitnearn/web/admin/blog/save/:blogId`
* **Middleware:** `authenticateAdminToken`, `authorize('EDIT_BLOG')`, `validateBlogStatus`
* **Controller:** `saveBlogPost`
* **URL Params:** `blogId`
* **Functioning:** finalizes edits, removes redundant images from S3, updates `Blog` to `under_review` or `ready_for_publish`, creates/updates `AdminBlogReview` record and notifies assignees.
  **Success:** blog moved to next stage with review entry.

---

### 8. Update Blog Status (publish / reject)

* **Method:** `PATCH`
* **URL:** `/api/fitnearn/web/admin/blog/status-update`
* **Middleware:** `authenticateAdminToken`, `authorize('PUBLISH_BLOG')`
* **Controller:** `updateBlogStatus`
* **Request Body:** `{ blogId, status, adminComments? }`
* **Functioning:** updates `status` (e.g., `published`, `rejected`), sets `publishedAt` on publish, triggers notifications/newsletter, invalidates caches as required.
  **Success:** updated blog returned.

---

### 9. Get All Blogs (filters & pagination)

* **Method:** `GET`
* **URL:** `/api/fitnearn/web/admin/blog/get`
* **Middleware:** `authenticateAdminToken`, `authorize('GET_BLOGS')`
* **Query Params (examples):** `status`, `stage`, `authorId`, `tag`, `page`, `limit`, `sort`
* **Functioning:** builds filters, supports pagination and sorting, returns list with minimal author info.
  **Success:** `{ data: [...], page, total }`.

---

### 10. Get Blog By ID

* **Method:** `GET`
* **URL:** `/api/fitnearn/web/admin/blog/:blogId`
* **Middleware:** `authenticateAdminToken`, `authorize('READ_BLOG')`
* **Controller:** `getBlogByBlogId`
* **URL Params:** `blogId`
* **Functioning:** returns full blog payload including images, author profile, version history and admin review records. Computes `isEditable` based on `stage` and `lock`.
  **Success:** full blog object.

---

### 11. Get Blogs Under Review / Edit Requests / Delete Requests

* **Method:** `GET`
* **URLs:**

  * `/api/fitnearn/web/admin/blog/get/review` — blogs under review
  * `/api/fitnearn/web/admin/blog/get/edit` — edit requests
  * `/api/fitnearn/web/admin/blog/get/delete` — delete requests
* **Middleware:** `authenticateAdminToken`, `authorize('GET_BLOGS')`
* **Controller:** `getBlogsUnderReview`, `getEditRequest`, `getDeleteRequestedBlogs`
* **Functioning:** filters by lifecycle flags and returns contextual lists for admin triage.

---

## Comment moderation — two domains

There are two separate comment domains:

1. **User-visible comments** (`BlogComment`) — conversation under a blog, visible to readers.

   * Routes under: `/api/fitnearn/web/admin/blog-comment/*`
2. **Admin-review comments** (`AdminBlogReview`) — reviewer/approver audit trail, stored inside `AdminBlogReview` documents.

   * Routes under: `/api/fitnearn/web/admin/blog/*` (e.g. `edit-comment`, `delete-comment`)

Both are covered below.

---

### A. Create Admin Comment (user-visible)

* **Method:** `POST`
* **URL:** `/api/fitnearn/web/admin/blog-comment/add`
* **Middleware:** `authenticateAdminToken`, `authorize('EDIT_BLOG')`, `idGenerationMiddleware('CMT')`
* **Controller:** `adminBlogComment`
* **Request Body:**

```json
{ "adminId": "...", "blogId": "...", "comment": "...", "parentCommentId?": "..." }
```

* **Functioning:** generates `commentId`, persists a `BlogComment` or reply, links replies and increments parent `replyCount`. Notifies blog author.
**Success:** `{ success: true, message: "Comment added", data: { /* comment */ } }`
**Errors:** `400`, `404`, `500`.

---

### B. Edit a User Comment (admin override)

* **Method:** `PATCH`
* **URL:** `/api/fitnearn/web/admin/blog-comment/edit`
* **Middleware:** `authenticateAdminToken`, `authorize('EDIT_BLOG')`
* **Controller:** `editAdminBlogComment`
* **Request Body:**

```json
{ "commentId": "...", "comment": "...", "adminId": "...", "blogId?": "..." }
```

* **Functioning:** finds root or reply and updates text, `updatedAt`, and `editedBy` audit fields.
**Errors:** `404`, `500`.

---

### C. Delete a User Comment or Reply (admin)

* **Method:** `DELETE`
* **URL:** `/api/fitnearn/web/admin/blog-comment/delete/:commentId`
* **Middleware:** `authenticateAdminToken`, `authorize('DELETE_COMMENT')`
* **Controller:** `adminDeleteCommentOrReply`
* **URL Params:** `commentId`
* **Functioning:** deletes root comment (and replies) or removes a reply (decrementing parent's `replyCount`). Cleans up likes/reports as needed. Soft delete may be applied per policy.
  **Success:** `200 { success: true, message: "Comment deleted" }`
  **Errors:** `404`, `500`.

---

### D. Get a User Comment (with replies & enrichment)

* **Method:** `GET`
* **URL:** `/api/fitnearn/web/admin/blog-comment/get/:commentId`
* **Middleware:** typically `authenticateAdminToken`, `authorize('GET_BLOGS')` (verify per route)
* **Controller:** `getBlogCommentById`
* **URL Params:** `commentId`
* **Functioning:** returns comment with replies; enriches each entry with author name/profile image for moderation UI.
  **Success:** `200 { success: true, data: { comment, replies: [...] } }`
  **Errors:** `404`, `500`.

---

### E. Set Comment Status (quick moderation toggle)

* **Method:** `PATCH`
* **URL:** `/api/fitnearn/web/admin/blog/set-status/:commentId`
* **Middleware:** `authenticateAdminToken`, `authorize('EDIT_BLOG')`, `validateBlogStatus`
* **Controller:** `setCommentStatus`
* **URL Params:** `commentId`
* **Query:** `status=active|flagged|deleted`
* **Functioning:** toggles `status` on `BlogComment` for soft moderation without deleting the record.
  **Success:** `200 { success: true, message: "Status updated to <status>" }`
  **Errors:** `400`, `404`.

---

### F. Edit Admin Review Comment (inside `AdminBlogReview`)

* **Method:** `PATCH`
* **URL:** `/api/fitnearn/web/admin/blog/edit-comment`
* **Middleware:** `authenticateAdminToken`, `authorize('EDIT_COMMENT')`
* **Controller:** `editComment`
* **Request Body:**

```json
{ "blogId", "commentId", "comment", "adminId" }
```

* **Functioning:** locates admin comment inside `AdminBlogReview` arrays (reviewer/approver) and updates text & timestamps. Only allowed while the review `lock === false`.
**Success:** updated `AdminBlogReview`.
**Errors:** `404`, `409` lock true, `500`.

---

### G. Delete Admin Review Comment (remove from `AdminBlogReview`)

* **Method:** `DELETE`
* **URL:** `/api/fitnearn/web/admin/blog/delete-comment`
* **Middleware:** `authenticateAdminToken`, `authorize('DELETE_COMMENT')`
* **Controller:** `deleteAdminComment`
* **Request Body:**

```json
{ "blogId", "commentId", "adminType" } // adminType = 'reviewer' | 'approver'
```

* **Functioning:** removes comment entry from the correct array in `AdminBlogReview` using `$pull` and returns updated review doc for audit.
**Success:** `200 { success: true, message: "Admin review comment deleted", data: { /* updated review */ } }`
**Errors:** `404`, `400`, `500`.

---

## Reported items (moderation)

* **Method:** `GET`
* **URLs:** `/api/fitnearn/web/admin/blog/reported` and `/api/fitnearn/web/admin/blog/reported-comments`
* **Middleware:** `authenticateAdminToken`, `authorize('GET_BLOGS')`
* **Controller:** `fetchReportedBlogs`, `fetchReportedComments`
* **Functioning:** returns reported blogs/comments (from `Report`) for moderator triage, with reporter details and status. Actions (delete/warn/resolve) are performed by moderators via other admin endpoints.

---

## Blog Analytics

* **Method:** `GET`
* **URL:** `/api/fitnearn/web/admin/blog/get-blog-analytics/:blogId`
* **Middleware:** `authenticateAdminToken`, `authorize('READ_BLOG')`
* **Controller:** `getBlogAnalytics`
* **Functioning:** aggregates views, likes, shares, comments, reports, reading time and returns summary + time series for dashboards.

---

### Delete Blog (admin)

* **Method:** `DELETE`
* **URL:** `/api/fitnearn/web/admin/blog/delete/:blogId`
* **Middleware:** `authenticateAdminToken`, `authorize('DELETE_BLOG')`
* **Controller:** `adminDeleteBlog`
* **Functioning:** soft or hard delete per policy; removes associated S3 images via `deleteImageFromS3`, clears/marks comments, and records audit trail.

---

## Notes & implementation considerations

* **Two comment domains:** keep UI and SDK explicit — `BlogComment` are user-visible comments; `AdminBlogReview` holds reviewer/approver audit comments. Different schemas and endpoints apply.
* **Lock semantics:** reviewer/approver flows allow draft edits while `lock === false`. Finalizing actions (`send_to_approver`, `approve`, `reject`) set `lock = true`. Clients should check `lock` before enabling edit actions.
* **Image lifecycle:** uploads go to S3 via `uploadImage` and create `BlogImage` entries. On removal, controllers call `deleteImageFromS3` and delete DB refs. `saveBlogPost` removes redundant images (images uploaded but not present in final blog content) — ensure controller checks `BlogImage` vs content and removes unused assets.
* **Versioning:** version creation makes snapshot copies and links via `previousVersionId` for rollback/history.
* **Permissions:** enforce granular permissions: reviewer vs approver vs publisher vs comment-moderator.
* **Moderation:** reported items feed into a moderator queue — actions should mark `Report` as `resolved` with audit.
* **Atomicity & consistency:** operations that touch bookings/payments/images should be transactional where possible or have compensating steps and robust error handling to avoid orphaned assets.

---

## Summary table (core endpoints)

| Method |                                Endpoint | Purpose                                         |
| ------ | --------------------------------------: | ----------------------------------------------- |
| POST   |                           `/save-draft` | Create/update admin draft                       |
| POST   |                          `/upload-file` | Upload image (S3)                               |
| POST   |                          `/review-blog` | Reviewer: save/request changes/send to approver |
| PATCH  |                      `/approver-review` | Approver: save/approve/reject                   |
| POST   |                 `/version-blog/:blogId` | Create version snapshot                         |
| PATCH  |                               `/update` | Update blog content/metadata                    |
| PATCH  |                         `/save/:blogId` | Finalize edits / send for review                |
| PATCH  |                        `/status-update` | Publish / reject blog                           |
| PATCH  |                      `/assign-reviewer` | Assign reviewer                                 |
| PATCH  |                      `/assign-approver` | Assign approver                                 |
| GET    |                                  `/get` | List blogs (filters)                            |
| GET    |                              `/:blogId` | Get full blog                                   |
| GET    |                 `/get-comments/:blogId` | Get admin-review comments                       |
| GET    |           `/get-blog-analytics/:blogId` | Blog analytics                                  |
| DELETE |                       `/delete/:blogId` | Delete blog                                     |
| POST   |               `/admin/blog-comment/add` | Add admin-created user-visible comment          |
| PATCH  |              `/admin/blog-comment/edit` | Edit user-visible comment                       |
| DELETE | `/admin/blog-comment/delete/:commentId` | Delete user-visible comment/reply               |
| GET    |    `/admin/blog-comment/get/:commentId` | Get comment with replies                        |
| PATCH  |     `/admin/blog/set-status/:commentId` | Quick comment status toggle                     |
| PATCH  |              `/admin/blog/edit-comment` | Edit admin-review comment                       |
| DELETE |            `/admin/blog/delete-comment` | Delete admin-review comment                     |

---
